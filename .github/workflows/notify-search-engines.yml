name: Notify Search Engines on Deployment

on:
  # التشغيل فقط عند اكتمال النشر بنجاح على GitHub Pages
  deployment_status:

jobs:
  notify:
    # العمل فقط إذا كان النشر ناجحًا (state == 'success')
    if: github.event.deployment_status.state == 'success'
    runs-on: ubuntu-latest
    steps:
      - name: 'Notify Google of the sitemap update'
        run: |
          # استخراج رابط بيئة النشر (e.g., https://nasr-realestate.github.io)
          SITEMAP_URL="${{ github.event.deployment.payload.web_url }}/sitemap.xml"
          
          echo "✅ Deployment successful. Environment URL: ${{ github.event.deployment.payload.web_url }}"
          echo " pinging Google with sitemap: ${SITEMAP_URL}"
          
          # إرسال إشعار (ping) إلى Google
          curl -s "https://www.google.com/ping?sitemap=${SITEMAP_URL}"
          
          echo "✅ Google has been notified!"

