name: Notify Search Engines (IndexNow)

on:
  push:
    branches:
      - main  # تأكد إذا كان اسم الفرع عندك main أو master
    paths:
      - '_properties/**'
      - '_requests/**'
      - 'sitemap.xml'
      - 'luxury-gallery.html'
      - 'search-data.json' # مراقبة أي تغيير في بيانات البحث

jobs:
  indexnow:
    runs-on: ubuntu-latest
    steps:

      - name: Notify Bing via IndexNow (Homepage)
        run: |
          # Ping فعال لمحرك Bing على الصفحة الرئيسية
          curl -X GET "https://nasr-realestate.github.io/?key=48316278893d467499696316278893d4"

      - name: Force Index Luxury Gallery
        run: |
          # تنبيه Bing/Yandex بوجود صفحة المعرض
          curl -I https://nasr-realestate.github.io/luxury-gallery.html

      - name: Verify Search Data Accessibility
        run: |
          # التأكد من أن ملف search-data.json متاح ولا يعطي 404
          curl -I https://nasr-realestate.github.io/search-data.json

      - name: Verify Sitemap Accessibility
        run: |
          # التأكد من أن خريطة الموقع متاحة بدون أي أخطاء XML
          curl -I https://nasr-realestate.github.io/sitemap.xml
