<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5BTRF7NP');</script>
  
  <!-- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„ÙƒÙŠØ© Ø¬ÙˆØ¬Ù„ -->
  <meta name="google-site-verification" content="ozxUgrS2657mo8HYSvgjhYSeYv1FCcc8ig_3wjmSoGA" />
  
  <!-- ØªØ­Ø³ÙŠÙ†Ø§Øª SEO Ø¥Ø¶Ø§ÙÙŠØ© -->
  <meta name="robots" content="index, follow, max-image-preview:large">
  <meta name="author" content="Ø·Ø§Ø±Ù‚ Ø·Ù†Ø·Ø§ÙˆÙŠ">
  <meta name="geo.region" content="EG-C">
  <meta name="geo.placename" content="Nasr City, Cairo">
  <meta name="geo.position" content="30.0635;31.311">
  <meta name="ICBM" content="30.0635, 31.311">
  
  <!-- =========================================================
       Ø§Ù„Ø³ÙŠÙˆ ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§ (WhatsApp & Facebook)
       ========================================================= -->
  {% seo %}

  <meta property="og:url" content="{{ site.url }}{{ page.url }}">
  <meta property="og:site_name" content="Ø³Ù…Ø³Ø§Ø± Ø·Ù„Ø¨Ùƒ">
  <meta property="og:title" content="{% if page.title %}{{ page.title }} | Ø³Ù…Ø³Ø§Ø± Ø·Ù„Ø¨Ùƒ{% else %}Ø³Ù…Ø³Ø§Ø± Ø·Ù„Ø¨Ùƒ - Ø¹Ù‚Ø§Ø±Ø§Øª Ù…Ø¯ÙŠÙ†Ø© Ù†ØµØ±{% endif %}">

  {% if page.image_file %}
    <meta property="og:image" content="{{ site.url }}{{ site.baseurl }}/assets/img/properties/{{ page.image_file }}">
    <meta name="twitter:image" content="{{ site.url }}{{ site.baseurl }}/assets/img/properties/{{ page.image_file }}">
  {% elsif page.collection == 'requests' or page.layout == 'request_page' %}
    <meta property="og:image" content="{{ site.url }}{{ site.baseurl }}/assets/img/social-request-default.webp">
    <meta name="twitter:image" content="{{ site.url }}{{ site.baseurl }}/assets/img/social-request-default.webp">
  {% else %}
    <meta property="og:image" content="{{ site.url }}{{ site.baseurl }}/assets/img/logo.webp">
    <meta name="twitter:image" content="{{ site.url }}{{ site.baseurl }}/assets/img/logo.webp">
  {% endif %}

  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  <!-- =========================================================
       Ø§Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
       ========================================================= -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" 
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" 
        crossorigin="anonymous" referrerpolicy="no-referrer">
  
  <!-- Ù…Ù„Ù Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ -->
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  
  <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
  <link rel="shortcut icon" type="image/x-icon" href="{{ '/assets/img/logo.webp' | relative_url }}">
  <link rel="apple-touch-icon" href="{{ '/assets/img/logo.webp' | relative_url }}">

  <!-- =========================================================
       ğŸ¨ Ø³ØªØ§ÙŠÙ„ Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ (Smart Search Custom CSS)
       ========================================================= -->
  <style>
    /* Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…ØªÙˆÙ‡Ø¬Ø© */
    .smart-search-trigger {
        position: fixed; bottom: 95px; left: 25px; width: 65px; height: 65px;
        background: linear-gradient(135deg, #d4af37 0%, #b8860b 100%);
        border-radius: 50%; display: flex; flex-direction: column;
        justify-content: center; align-items: center; z-index: 9991; cursor: pointer;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .smart-search-trigger i { color: #000; font-size: 1.5rem; }
    .trigger-text { color: #000; font-size: 0.6rem; font-weight: 900; margin-top: 2px; }
    .pulse-ring {
        position: absolute; width: 100%; height: 100%; border-radius: 50%;
        background: #d4af37; animation: smart-pulse 2.5s infinite; z-index: -1;
    }
    @keyframes smart-pulse { 0% { transform: scale(1); opacity: 0.5; } 100% { transform: scale(1.8); opacity: 0; } }

    /* Ù…Ø³Ø±Ø­ Ø§Ù„Ø¨Ø­Ø« (Overlay) */
    .smart-search-overlay {
        position: fixed; inset: 0; z-index: 10000; display: none;
        justify-content: center; align-items: center; padding: 20px;
    }
    .overlay-blur { position: absolute; inset: 0; background: rgba(5, 5, 5, 0.92); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); }

    /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
    .smart-card {
        position: relative; width: 100%; max-width: 450px; background: #111;
        border: 1px solid rgba(212, 175, 55, 0.2); border-radius: 30px;
        padding: 35px 25px; text-align: center; display: none;
        box-shadow: 0 40px 100px rgba(0,0,0,0.8); transform: translateY(30px); opacity: 0;
        transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    }
    .smart-card.active { display: block; transform: translateY(0); opacity: 1; }
    .gold-icon { font-size: 3rem; color: #d4af37; margin-bottom: 15px; filter: drop-shadow(0 0 10px rgba(212,175,55,0.3)); }
    .smart-card h2 { color: #fff; font-size: 1.6rem; font-weight: 900; margin-bottom: 10px; }
    .smart-card p { color: #aaa; font-size: 0.95rem; margin-bottom: 25px; }

    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± */
    .choice-grid { display: grid; grid-template-columns: 1fr; gap: 12px; }
    .choice-btn {
        background: #050505; border: 1px solid #222; padding: 16px 20px;
        border-radius: 12px; color: #fff; display: flex; align-items: center;
        gap: 15px; cursor: pointer; transition: 0.3s; text-align: right; font-family: 'Cairo';
    }
    .choice-btn:hover { border-color: #d4af37; transform: translateX(-5px); background: rgba(212,175,55,0.05); }
    .choice-btn i { color: #d4af37; font-size: 1.2rem; min-width: 25px; text-align: center; }
    .choice-btn span { font-weight: 700; font-size: 1rem; }

    .back-text-btn {
        margin-top: 25px; background: none; border: none; color: #d4af37;
        cursor: pointer; font-family: 'Cairo'; font-size: 0.85rem; font-weight: 700;
        display: flex; align-items: center; gap: 8px; margin: 25px auto 0;
    }
    .close-text-btn { margin-top: 25px; background: none; border: none; color: #555; cursor: pointer; font-family: 'Cairo'; text-decoration: underline; font-size: 0.85rem; }

    /* Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© */
    .smart-search-overlay a, .smart-search-overlay button { -webkit-tap-highlight-color: transparent; }
  </style>
  
</head>

<body class="{{ page.body_class | default: 'default-page' }}">

  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5BTRF7NP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  <div class="cinematic-bg"></div>
  <div class="animated-overlay"></div>

  {% include navbar.html %}

  <main>
    {{ content }}
  </main>

  {% include footer.html %}

  <!-- =========================================================
       ğŸ” Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ (UI Structure)
       ========================================================= -->
  
  <!-- 1. Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…ØªÙˆÙ‡Ø¬Ø© -->
  <div id="smartSearchTrigger" class="smart-search-trigger" onclick="openSmartSearch()">
      <div class="pulse-ring"></div>
      <i class="fas fa-hand-sparkles"></i>
      <span class="trigger-text">ØµÙ…Ù… Ø·Ù„Ø¨Ùƒ</span>
  </div>

  <!-- 2. Ù…Ø³Ø±Ø­ Ø§Ù„Ø¨Ø­Ø« (Cards) -->
  <div id="smartSearchOverlay" class="smart-search-overlay">
      <div class="overlay-blur" onclick="closeSmartSearch()"></div>
      
      <div class="search-card-container">
          <!-- Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© 1: Ø§Ù„Ù†ÙˆØ¹ -->
          <div class="smart-card" id="step1">
              <i class="fas fa-crown gold-icon"></i>
              <h2>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù†Ø®Ø¨Ø©</h2>
              <p>Ù†Ø­Ù† Ù„Ø§ Ù†Ø¹Ø±Ø¶ Ø¬Ø¯Ø±Ø§Ù†Ø§Ù‹ØŒ Ø¨Ù„ Ù†ØµÙ…Ù… Ù„Ùƒ Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹.. Ù…Ø§Ø°Ø§ Ù†Ø¨Ø­Ø« Ø¹Ù†Ù‡ Ø§Ù„ÙŠÙˆÙ…ØŸ</p>
              <div class="choice-grid">
                  <button class="choice-btn" onclick="nextStep('apartments', 'ØªÙ…Ù„ÙŠÙƒ')"><i class="fas fa-home"></i> <span>ØªÙ…Ù„ÙŠÙƒ Ø§Ù„Ø¹Ù…Ø±</span></button>
                  <button class="choice-btn" onclick="nextStep('apartments-rent', 'Ø¥ÙŠØ¬Ø§Ø± Ù…ÙØ±ÙˆØ´')"><i class="fas fa-couch"></i> <span>Ø¥ÙŠØ¬Ø§Ø± Ù…ÙØ±ÙˆØ´ (ÙÙ†Ø¯Ù‚ÙŠ)</span></button>
                  <button class="choice-btn" onclick="nextStep('apartments-rent', 'Ø¥ÙŠØ¬Ø§Ø± Ø¬Ø¯ÙŠØ¯')"><i class="fas fa-key"></i> <span>Ø¥ÙŠØ¬Ø§Ø± Ø¬Ø¯ÙŠØ¯ (ÙØ§Ø¶ÙŠ)</span></button>
                  <button class="choice-btn" onclick="nextStep('commercial', 'ØªØ¬Ø§Ø±ÙŠ/Ø¥Ø¯Ø§Ø±ÙŠ')"><i class="fas fa-chart-line"></i> <span>ØªØ¬Ø§Ø±ÙŠ ÙˆØ¥Ø¯Ø§Ø±ÙŠ</span></button>
              </div>
              <button class="close-text-btn" onclick="closeSmartSearch()">Ø³Ø£Ù‚ÙˆÙ… Ø¨Ø§Ù„ØªØµÙØ­ Ø¨Ù†ÙØ³ÙŠ Ù„Ø§Ø­Ù‚Ø§Ù‹</button>
          </div>

          <!-- Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© 2: Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© -->
          <div class="smart-card" id="step2">
              <i class="fas fa-money-bill-wave gold-icon"></i>
              <h2 id="budgetTitle">ÙˆÙ…Ø§ Ù‡ÙŠ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ù…Ø±ØµÙˆØ¯Ø©ØŸ</h2>
              <p>Ù„Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø¹Ø±Ø¶ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªÙŠ ØªÙ†Ø§Ø³Ø¨ Ù‚Ø¯Ø±Ø§ØªÙƒ Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø¨Ø¯Ù‚Ø©.</p>
              <div id="budgetOptions" class="choice-grid"></div>
              <button class="back-text-btn" onclick="backToStep1()"><i class="fas fa-arrow-right"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</button>
          </div>
      </div>
  </div>

  <!-- Ø²Ø± Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø«Ø§Ø¨Øª Ø§Ù„Ø£ØµÙ„ÙŠ -->
  <a href="tel:+201147758857" 
     class="fixed-call-button"
     aria-label="Ø§ØªØµÙ„ Ø§Ù„Ø¢Ù† Ø¨Ø³Ù…Ø³Ø§Ø± Ø·Ù„Ø¨Ùƒ"
     onclick="trackPhoneCall('+201147758857', 'Fixed Button - {{ page.title | default: site.title }}');">
    <i class="fas fa-phone-alt"></i>
    <span>Ø§ØªØµÙ„ Ø§Ù„Ø¢Ù†: 01147758857</span>
  </a>

  <!-- =========================================================
       âš™ï¸ Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ø°ÙƒÙŠ (Logic)
       ========================================================= -->
  <script>
    let userSelection = { category: '', type: '', budgetRange: [] };

    function openSmartSearch() {
        document.getElementById('smartSearchOverlay').style.display = 'flex';
        setTimeout(() => { document.getElementById('step1').classList.add('active'); }, 10);
    }

    function closeSmartSearch() {
        document.querySelectorAll('.smart-card').forEach(c => c.classList.remove('active'));
        setTimeout(() => { document.getElementById('smartSearchOverlay').style.display = 'none'; }, 500);
    }

    function nextStep(category, typeLabel) {
        userSelection.category = category;
        userSelection.type = typeLabel;
        document.getElementById('step1').classList.remove('active');
        setupBudgetOptions(typeLabel);
        setTimeout(() => { document.getElementById('step2').classList.add('active'); }, 400);
    }

    function backToStep1() {
        document.getElementById('step2').classList.remove('active');
        setTimeout(() => { document.getElementById('step1').classList.add('active'); }, 400);
    }

    function setupBudgetOptions(type) {
        const container = document.getElementById('budgetOptions');
        const title = document.getElementById('budgetTitle');
        container.innerHTML = ''; 
        let options = [];

        if (type === 'ØªÙ…Ù„ÙŠÙƒ') {
            title.innerText = "Ù…ÙŠØ²Ø§Ù†ÙŠØ© ØªÙ…Ù„ÙŠÙƒ Ø§Ù„Ø¹Ù…Ø±ØŸ";
            options = [
                { label: "Ø£Ù‚Ù„ Ù…Ù† 3 Ù…Ù„ÙŠÙˆÙ† Ø¬.Ù…", range: [0, 3000000] },
                { label: "Ù…Ù† 3 Ø¥Ù„Ù‰ 6 Ù…Ù„ÙŠÙˆÙ† Ø¬.Ù…", range: [3000000, 6000000] },
                { label: "Ø£ÙƒØ«Ø± Ù…Ù† 6 Ù…Ù„ÙŠÙˆÙ† Ø¬.Ù…", range: [6000000, 99999999] }
            ];
        } else if (type.includes('Ø¥ÙŠØ¬Ø§Ø±')) {
            title.innerText = "Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ø´Ù‡Ø±ÙŠØŸ";
            options = [
                { label: "Ø£Ù‚Ù„ Ù…Ù† 15 Ø£Ù„Ù Ø¬.Ù…", range: [0, 15000] },
                { label: "Ù…Ù† 15 Ø¥Ù„Ù‰ 30 Ø£Ù„Ù Ø¬.Ù…", range: [15000, 30000] },
                { label: "Ø£ÙƒØ«Ø± Ù…Ù† 30 Ø£Ù„Ù Ø¬.Ù…", range: [30000, 999999] }
            ];
        } else {
            title.innerText = "Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„ØªØ¬Ø§Ø±ÙŠØŸ";
            options = [
                { label: "Ø£Ù‚Ù„ Ù…Ù† 5 Ù…Ù„ÙŠÙˆÙ† Ø¬.Ù…", range: [0, 5000000] },
                { label: "Ù…Ù† 5 Ø¥Ù„Ù‰ 15 Ù…Ù„ÙŠÙˆÙ† Ø¬.Ù…", range: [5000000, 15000000] },
                { label: "Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ù…ÙØªÙˆØ­Ø© Ù„Ù„ØªÙˆÙƒÙŠÙ„Ø§Øª", range: [15000000, 999999999] }
            ];
        }

        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'choice-btn';
            btn.innerHTML = `<i class="fas fa-coins"></i> <span>${opt.label}</span>`;
            btn.onclick = () => finishSearch(opt.range);
            container.appendChild(btn);
        });
    }

    function finishSearch(range) {
        userSelection.budgetRange = range;
        // Ø³ÙŠØªÙ… Ø±Ø¨Ø·Ù‡Ø§ Ø¨Ù…Ù„Ù Ø§Ù„Ù€ JSON ÙÙŠ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
        alert("Ø±Ø§Ø¦Ø¹! Ù…ÙŠØ²Ø§Ù†ÙŠØªÙƒ Ù‡ÙŠ " + userSelection.budgetRange[0] + " Ø¬.Ù…. Ø³Ø£Ù‚ÙˆÙ… Ø§Ù„Ø¢Ù† Ø¨Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©...");
    }
  </script>

</body>
</html>
