<!-- Ù…Ù„Ù Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø© Ù„Ù„Ù€SEO) -->

{% assign main_color = "#d4af37" %}
{% assign label_text = "Ø¹Ø±Ø¶" %}
{% assign icon_type = "fa-certificate" %}
{% assign item_url = include.item.url | relative_url %}

{% if include.item.collection == 'requests' %}
    {% assign main_color = "#0a84ff" %}
    {% assign label_text = "Ù…Ø·Ù„ÙˆØ¨" %}
    {% assign icon_type = "fa-bullhorn" %}
{% elsif include.item.title contains "Ø¥ÙŠØ¬Ø§Ø±" %}
    {% assign main_color = "#fce205" %}
    {% assign label_text = "Ø¥ÙŠØ¬Ø§Ø±" %}
    {% assign icon_type = "fa-key" %}
{% endif %}

<div class="property-card" 
     onclick="window.location.href='{{ item_url }}'" 
     style="cursor: pointer; border-top: 4px solid {{ main_color }}; overflow: hidden; display: flex; flex-direction: column; height: 100%;"
     itemscope itemtype="https://schema.org/RealEstateListing">
    
    <!-- ğŸ–¼ï¸ Ø­Ø§Ù„Ø© ÙˆØ¬ÙˆØ¯ ØµÙˆØ±Ø© (Ø¯Ø¹Ù… image_file Ø£Ùˆ image) -->
    {% if include.item.image_file or include.item.image %}
    <div class="card-image" style="height: 200px; overflow: hidden; position: relative;">
        
        {% if include.item.image_file %}
            {% assign img_src = "/assets/img/properties/" | append: include.item.image_file | relative_url %}
        {% else %}
            {% assign img_src = include.item.image | relative_url %}
        {% endif %}

        <img src="{{ img_src }}" 
             alt="{{ include.item.title }} - Ø´Ù‚Ø© Ù„Ù„Ø¨ÙŠØ¹ ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© Ù†ØµØ±" 
             loading="lazy"
             itemprop="image"
             style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease;">
        
        <!-- Ø§Ù„Ø´Ø§Ø±Ø© ÙÙˆÙ‚ Ø§Ù„ØµÙˆØ±Ø© -->
        <span style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.8); color: {{ main_color }}; padding: 4px 12px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; border: 1px solid {{ main_color }};">
            <i class="fas {{ icon_type }}"></i> {{ label_text }}
        </span>
    </div>
    
    <!-- ğŸ“„ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Øµ ÙÙ‚Ø· (Ø¨Ø¯ÙˆÙ† ØµÙˆØ±Ø©) -->
    {% else %}
    <div style="padding: 15px 15px 0 15px; display:flex; justify-content:space-between; align-items: center;">
        <span style="color: {{ main_color }}; background: rgba(255,255,255,0.05); padding: 4px 12px; border-radius: 10px; font-size: 0.8rem; border: 1px solid {{ main_color }};">
            <i class="fas {{ icon_type }}"></i> {{ label_text }}
        </span>
        <span style="color:#666; font-size: 0.8rem;">Ø¬Ø¯ÙŠØ¯</span>
    </div>
    {% endif %}

    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© -->
    <div class="card-content" style="padding: 15px; flex-grow: 1; display: flex; flex-direction: column;">
        
        <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
        <h3 class="property-title" 
            style="color:#fff; font-size:1.1rem; margin: 0 0 10px 0; line-height: 1.4;"
            itemprop="name">
            {{ include.item.title }}
        </h3>
        
        <!-- Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
        <p style="color:#b0b0b0; font-size:0.9rem; margin-bottom: 15px;" itemprop="address">
            <i class="fas fa-map-marker-alt" style="color: {{ main_color }};"></i> 
            <span itemprop="addressLocality">{{ include.item.location }}</span>
        </p>

        <!-- Ø§Ù„Ø³Ø¹Ø± -->
        <div style="color: {{ main_color }}; font-weight: bold; font-size: 1.1rem; margin-bottom: 10px;" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
            {% if include.item.budget %} 
                <span itemprop="priceSpecification">Ù…ÙŠØ²Ø§Ù†ÙŠØ©: {{ include.item.budget }}</span>
            {% else %} 
                <span itemprop="priceSpecification">{{ include.item.price }}</span>
            {% endif %}
            <meta itemprop="priceCurrency" content="EGP">
        </div>

        <!-- Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª -->
        <div style="display: flex; gap: 15px; font-size: 0.85rem; color: #ccc; margin-bottom: 15px;">
            {% if include.item.area %}
            <span itemprop="floorSize">
                <i class="fas fa-ruler-combined"></i> {{ include.item.area }}
            </span>
            {% endif %}
            
            {% if include.item.rooms %}
            <span itemprop="numberOfRooms">
                <i class="fas fa-bed"></i> {{ include.item.rooms }}
            </span>
            {% endif %}
        </div>

        <!-- Ø²Ø± Ø§Ù„ØªÙØ§ØµÙŠÙ„ -->
        <div style="margin-top: auto; padding-top: 10px; border-top: 1px solid #333; text-align: left;">
            <a href="{{ item_url }}" 
               style="color: #aaa; font-size: 0.9rem; transition: 0.3s; display: inline-flex; align-items: center; gap: 5px; text-decoration: none;"
               aria-label="Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ {{ include.item.title }}">
                Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„ <i class="fas fa-arrow-left" style="color: {{ main_color }};"></i>
            </a>
        </div>

    </div>
</div>

<style>
    .property-card:hover img { 
        transform: scale(1.1); 
    }
    
    .property-card:hover { 
        transform: translateY(-5px); 
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        transition: all 0.3s ease;
    }
    
    .property-card {
        transition: all 0.3s ease;
    }
</style>

<script>
// ØªØªØ¨Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
document.addEventListener('DOMContentLoaded', function() {
    var cards = document.querySelectorAll('.property-card');
    cards.forEach(function(card) {
        card.addEventListener('click', function() {
            var title = this.querySelector('.property-title').textContent;
            if (typeof gtag === 'function') {
                gtag('event', 'property_card_click', {
                    'event_category': 'Property Cards',
                    'event_label': title
                });
            }
        });
    });
});
</script>
