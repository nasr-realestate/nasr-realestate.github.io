<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Camera Smart Meter</title>

<style>
body {
    margin: 0;
    font-family: Cairo, sans-serif;
    background: #000;
    color: #fff;
}
#camera {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.overlay {
    position: fixed;
    bottom: 0;
    width: 100%;
    background: rgba(0,0,0,0.6);
    padding: 20px;
    text-align: center;
}
button {
    padding: 14px 20px;
    margin: 10px;
    font-size: 1rem;
    border: none;
    border-radius: 6px;
    background: #d4af37;
    font-weight: bold;
}
.result {
    margin-top: 10px;
    font-size: 1.2rem;
    color: #d4af37;
}
.notice {
    font-size: 0.75rem;
    color: #aaa;
}
</style>
</head>

<body>

<video id="camera" autoplay playsinline></video>

<div class="overlay">
    <button onclick="startMeasure()">ğŸ“ Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</button>
    <button onclick="endMeasure()">ğŸ Ù†Ù‚Ø·Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</button>
    <div class="result" id="output">â€”</div>
    <div class="notice">
        Ø§Ù„Ù‚ÙŠØ§Ø³ ØªÙ‚Ø±ÙŠØ¨ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø­Ø±ÙƒØ© Ø§Ù„Ù‡Ø§ØªÙ
    </div>
</div>

<script>
let startTime = null;
let distance = 0;
let velocity = 0;

navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
.then(stream => {
    document.getElementById("camera").srcObject = stream;
});

window.addEventListener("devicemotion", e => {
    if (!startTime) return;

    const acc = e.accelerationIncludingGravity;
    if (!acc) return;

    const ax = acc.x || 0;
    const ay = acc.y || 0;
    const az = acc.z || 0;

    const a = Math.sqrt(ax*ax + ay*ay + az*az) - 9.8;
    const now = Date.now();
    const dt = (now - startTime.last) / 1000;

    velocity += a * dt;
    distance += velocity * dt;

    startTime.last = now;
});

function startMeasure() {
    startTime = { last: Date.now() };
    distance = 0;
    velocity = 0;
    document.getElementById("output").innerText = "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø­Ø±ÙƒØ©...";
}

function endMeasure() {
    startTime = null;
    document.getElementById("output").innerText =
        "Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠØ©: " + Math.abs(distance).toFixed(2) + " Ù…ØªØ±";
}
</script>

</body>
</html>
